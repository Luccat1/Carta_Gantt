---
phase: 3
plan: 2
wave: 1
---

# Plan 3.2: Data Validation Logic

## Objective
Implement validation features to ensure data integrity in the `TASKS` sheet, including Start <= End date checks.

## Context
- .gsd/SPEC.md (REQ-07)
- Main.gs
- Config.gs

## Tasks

<task type="auto">
  <name>Implement Validation Logic</name>
  <files>Validation.gs, Main.gs</files>
  <action>
    1. Create `Validation.gs`.
       - Implement `validateTasksData()`.
       - **Logic**:
         - Read all data from `TASKS`.
         - Iterate rows and check:
           - Start Date (Col F) is a valid Date.
           - End Date (Col G) is a valid Date.
           - Check: `Start <= End`.
         - Collect all errors (Task Name, Row #, Error Type).
         - If errors exist: Show UI Alert with summary ("Task at Row X has invalid dates").
         - If no errors: Show success "Data Validated".
    2. Update `Main.gs`:
       - Add menu item "Validar datos" -> `validateTasksData`.
       - Optional: Call `validateTasksData` inside `refreshGanttView` and stop if critical errors found (or just warn). *Decision: Just warn or separate action for now to avoid blocking.*
  </action>
  <verify>test-path Validation.gs; Select-String -Path Validation.gs -Pattern "function validateTasksData"</verify>
  <done>Validation logic implemented and integrated into menu.</done>
</task>

## Success Criteria
- [ ] `validateTasksData` correctly identifies reverse dates (Start > End).
- [ ] UI alerts user of specific row errors.
