---
phase: 1
plan: 2
wave: 1
---

# Plan 1.2: Calendar Logic Implementation

## Objective
Implement core calendar functions to generate weekly breakdowns (S1-S4) and helper functions for date manipulation.

## Context
- .gsd/SPEC.md (REQ-02)
- Main.gs (from 1.1)

## Tasks

<task type="auto">
  <name>Implement Date Helpers</name>
  <files>Helpers.gs</files>
  <action>
    Create `Helpers.gs`.
    - Implement `monthNameEs_(monthNumber)`: Returns Spanish month name (1 -> "ene").
    - Implement `weeksOfMonth_(year, month)`: Returns an array of 4 objects {S: 1, start: date, end: date, label: "mon S1"}.
      - Logic: S1 (1-7), S2 (8-14), S3 (15-21), S4 (22-end of month).
  </action>
  <verify>test-path Helpers.gs</verify>
  <done>Helpers.gs exists with month helper functions.</done>
</task>

<task type="auto">
  <name>Implement Calendar Builder</name>
  <files>Calendar.gs</files>
  <action>
    Create `Calendar.gs`.
    - Implement `buildCalendarFromConfig()`:
      - Read Year and Month from `CONFIG` sheet (B1, B2).
      - Clear contents of `LOOKUPS`.
      - Use `weeksOfMonth_` to get weekly ranges.
      - Write to `LOOKUPS`: Headers (Week, Start, End, Label) followed by rows.
  </action>
  <verify>test-path Calendar.gs</verify>
  <done>Calendar.gs exists with buildCalendarFromConfig function.</done>
</task>

## Success Criteria
- [ ] `lookup` sheet is populated with correct date ranges for selected month.
- [ ] Helper functions handle month boundaries correctly (e.g., Feb 28/29).
