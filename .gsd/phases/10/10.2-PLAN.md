---
phase: 10
plan: 2
wave: 1
---

# Plan 10.2: Drive Folder Management

## Objective
Auto-create a folder structure in Google Drive for each project. This keeps project documents organized and accessible from the spreadsheet.

## Context
- Config.gs ‚Äî HEADERS_PROJECTS, SHEET_PROJECTS
- Main.gs ‚Äî onOpen menu
- Helpers.gs ‚Äî getHeaderMap_, getColIndex_

## Tasks

<task type="auto">
  <name>Create DriveManager.gs with createProjectFolders function</name>
  <files>DriveManager.gs (NEW)</files>
  <action>
    1. Create `DriveManager.gs` with a `createProjectFolders()` function:
       a. Prompt user for a root folder name via `ui.prompt()`. Default: 'Gantt - Proyectos'.
       b. Get or create the root folder:
          - Search for existing: `DriveApp.getFoldersByName(rootName)`.
          - If not found, create it: `DriveApp.createFolder(rootName)`.
       c. Read all project rows from PROJECTS sheet.
       d. For each project with a `Nombre`:
          - Check if a subfolder with that name already exists under root.
          - If not, create it: `rootFolder.createFolder(projectName)`.
          - Inside each project folder, create standard subfolders if missing:
            - 'Documentos'
            - 'Entregas'
            - 'Recursos'
       e. Show summary alert: "Estructura de carpetas creada/verificada. X proyectos, Y carpetas nuevas."
    2. Create a `getProjectFolderUrl(projectName)` helper that returns the URL of a project's folder (for use in future linking).
    3. Add comprehensive error handling with try/catch.
  </action>
  <verify>Code review: createProjectFolders exists with idempotent folder creation</verify>
  <done>Drive folder structure auto-created for each project</done>
</task>

<task type="auto">
  <name>Add Drive menu item</name>
  <files>Main.gs</files>
  <action>
    1. In Main.gs `onOpen()`: Add menu item "üìÅ Crear carpetas en Drive" calling `createProjectFolders`.
    2. Place it after the Calendar sync item.
  </action>
  <verify>Code review: menu item added</verify>
  <done>Drive folder creation accessible from Gantt menu</done>
</task>

## Success Criteria
- [ ] createProjectFolders creates a root folder with project subfolders
- [ ] Standard subfolders (Documentos, Entregas, Recursos) created per project
- [ ] Idempotent: re-running doesn't create duplicates
- [ ] Menu item added to Gantt ‚öôÔ∏è
