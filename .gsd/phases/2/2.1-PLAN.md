---
phase: 2
plan: 1
wave: 1
---

# Plan 2.1: Gantt View Construction

## Objective
Implement `refreshGanttView()` to map tasks from the `TASKS` sheet to the `GANTT_VIEW` sheet and dynamically generate the weekly calendar columns based on `LOOKUPS`.

## Context
- .gsd/SPEC.md (REQ-03)
- Main.gs (placeholder to replace)
- Config.gs (constants)
- Calendar.gs (for lookup logic understanding)

## Tasks

<task type="auto">
  <name>Implement Gantt View Logic</name>
  <files>Gantt.gs, Main.gs</files>
  <action>
    1. Create `Gantt.gs`.
       - Implement `refreshGanttView()` function.
       - Logic:
         - Clear entire `SHEET_GANTT`.
         - **Header Generation**:
           - Read static `HEADERS_TASKS` from Config.
           - Read dynamic week headers from `SHEET_LOOKUPS` (A2:D).
           - Combine static headers + Week Labels ("oct S1", etc.) and set in `GANTT_VIEW` row 1.
         - **Data Mapping**:
           - Read all data from `SHEET_TASKS`.
           - Filter out empty rows.
           - Write static task data to `SHEET_GANTT` (Columns A to K).
    2. Update `Main.gs`:
       - Remove placeholder `refreshGanttView`.
       - Ensure `refreshGanttView` in `onOpen` menu points to the new function in `Gantt.gs`.
  </action>
  <verify>test-path Gantt.gs; Select-String -Path Gantt.gs -Pattern "function refreshGanttView"</verify>
  <done>Gantt.gs exists and contains logic to populate headers and task data.</done>
</task>

## Success Criteria
- [ ] `GANTT_VIEW` sheet is populated with Headers (Static + Dynamic weeks).
- [ ] `GANTT_VIEW` sheet contains all tasks from `TASKS`.
